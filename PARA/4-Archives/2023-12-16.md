---
创建时间: 2024-01-05
最后修改: 2026-02-15
状态:
  - Archives
tags:
  - #linux
para: archives
aliases: []
---
# Sudo技巧
#linux 
## 编辑 sudo 配置时，请始终使用 visudo

**visudo 会在你试图保存更改时执行语法检查**。这能确保你不会因为语法错误而误改 `sudo` 配置。

## sudo部分设置

**Defaults        env_reset, timestamp_timeout=XX, pwfeedback,passwd_tries=N

 - `pwfeedback`：输入密码时会显示星号；
 - `timestamp_timeout=XX` ：密码超时时限，`XX` 是以分钟为单位的超时时长；
 - `passwd_tries=N`：用户可以输入错误密码的次数。

``` config
Defaults   insults
```

在你每次输错密码时，[让 sudo 抛出随机的“侮辱”](https://itsfoss.com/sudo-insult-linux/)。
### 无密码sudo

**user_name ALL=(ALL) NOPASSWD:ALL

### 配置独立的 sudo 日志文件

**Defaults  logfile="/var/log/sudo.log"

## 限制特定用户组使用 sudo 执行特定命令

这是一种高级解决方案，系统管理员在需要跨部门共享服务器的多用户环境中会使用。

开发者可能会需要以 root 权限运行 Web 服务器或其他程序，但全权给予他们 `sudo` 权限会带来安全风险。我建议在群组级别进行此项操作。例如，创建命名为 `coders` 的群组，并允许它们运行在 `/var/www` 和 `/opt/bin/coders` 目录下的命令（或可执行文件），以及 [inxi 命令](https://itsfoss.com/inxi-system-info-linux/)（路径是 `/usr/bin/inxi` 的二进制文件）。这是一个假想情景，实际操作请谨慎对待。

接下来，用 `sudo visudo` 编辑 sudoer 文件，再添加以下行:

```config
%coders   ALL=(ALL:ALL) /var/www,/opt/bin/coders,/usr/bin/inxi
```

如有需要，可以添加 `NOPASSWD` 参数，这样允许使用 `sudo` 运行的命令就不再需要密码了。